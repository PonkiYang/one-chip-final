C51 COMPILER V9.60.7.0   MAIN                                                              12/21/2023 02:04:33 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\DevPrograms\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\L
                    -istings\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <regx52.h>
   2          #include "LCD1602.h"
   3          #include "Key.h"
   4          #include "Timer.h"
   5          
   6          int i = 0;
   7          double price;
   8          int flag = 1;                                                   // 1‰∏∫ÁôΩÁè≠Ê®°Âºè,0‰∏∫Â§úÁè≠Ê®°Âºè.
   9          int run = 1;                                                    // 1‰∏∫Ë°åÈ©∂Áä∂ÊÄÅ,0‰∏∫ÂÅúÊªûÁä∂ÊÄÅ
  10          int begun = 0;                                                  // 1‰∏∫Â∑≤ÁªèÂêØÂä®ÔºåÊ≠§Êó∂ÊåâK2ÊåâÈîÆ‰∏ç‰ºöÂ¢ûÂä†Ëµ∑Ê≠•Ë¥πÔºå0‰∏∫ËøòÊú™ÂêØÂä®ÔºåÊ≠§
             -Êó∂ÊåâK2ÊåâÈîÆ‰ºöÂ¢ûÂä†Ëµ∑Ê≠•Ë¥π„ÄÇ
  11          int keyNum;                                                             // ÊåâÈîÆ‰ª£Êï∞
  12          int dist = 0;                                                   // Ë∑ØÁ®ã
  13          char Hour = 0, Sec = 0, Min = 0;                // Á≠âÂæÖÊó∂Èó¥
  14          int Mins = 0;                                                   // ÊÄªÁ≠âÂæÖÊó∂Èó¥ÔºàÂçï‰Ωç‰∏∫ÂàÜÈíüÔºâ
  15          unsigned int runSec = 0, runMin = 0;    // Ë°åÈ©∂Êó∂Èó¥ÔºàÂçï‰Ωç‰∏∫ÂàÜÈíüÔºâ
  16          char s10 = 0;                                                   // Ë°®Á§∫10ÁßíËøáÊ≤°ËøáÔºå‰∏∫0ÂàôÊ≤°ËøáÔºå‰∏∫1ÂàôËøá‰∫ÜÔºåÁî®‰∫éwhile(1){}‰∏≠ÊúÄÂêé‰∏Ä
             -‰∏™Âà§Êñ≠
  17          
  18          void main(){
  19   1              LCD_Init();
  20   1              Timer0Init();                                   // ÂÆöÊó∂Âô®0ËÆ°ÁÆóÁ≠âÂæÖÊó∂Èó¥
  21   1              Timer1Init();                                   // ÂÆöÊó∂Âô®1ËÆ°ÁÆóË°åÈ©∂Êó∂Èó¥
  22   1              LCD_ShowString(1, 1, "Day");    // ÈªòËÆ§‰∏∫ÁôΩÁè≠Ê®°Âºè
  23   1              LCD_ShowString(2, 5,"km");
  24   1              LCD_ShowString(2, 11,":  :  ");
  25   1              while(1){
  26   2                      // ÊòæÁ§∫Ë∑ØÁ®ã
  27   2                      LCD_ShowNum(2, 1, dist, 4);
  28   2                      // ÊòæÁ§∫Á≠âÂæÖÊó∂Èó¥
  29   2                      LCD_ShowNum(2, 9, Hour,2);
  30   2                      LCD_ShowNum(2, 12, Min, 2);
  31   2                      LCD_ShowNum(2, 15, Sec, 2);
  32   2                      keyNum = Key();
  33   2                      if (keyNum == 1){                       // ÂàáÊç¢Èªë/ÁôΩÁè≠Ê®°Âºè
  34   3                              flag = 1 - flag;
  35   3                              if(flag){
  36   4                                      LCD_ShowString(1, 1, "Day  ");
  37   4                              } else {
  38   4                                      LCD_ShowString(1, 1, "Night");
  39   4                              }
  40   3                      }else if (keyNum == 2){         // ÂºÄÂßãËÆ°Ë¥π„ÄÅÂêØÂä®
  41   3                              if(begun == 0){
  42   4                                      if (flag){
  43   5                                              price += 10.0;
  44   5                                      } else {
  45   5                                              price += 11.0;
  46   5                                      }
  47   4                                      LCD_ShowString(1, 9, "stop");
  48   4                              }
  49   3                              begun = 1;
  50   3                              TR0 = 1;                                // ÊâìÂºÄÂÆöÊó∂Âô®0,ËÆ°ÁÆóÁ≠âÂæÖÊó∂Èó¥
  51   3                              
  52   3      
C51 COMPILER V9.60.7.0   MAIN                                                              12/21/2023 02:04:33 PAGE 2   

  53   3                      }else if (keyNum == 3){         // ÂàáÊç¢Ë°åÈ©∂/ÂÅúÊªûÁä∂ÊÄÅ
  54   3                              run = 1 - run;
  55   3                              if(TR0 == 0){
  56   4                                      TR0 = 1;
  57   4                                      TR1 = 0;
  58   4                              } else {
  59   4                                      TR0 = 0;
  60   4                                      TR1 = 1;
  61   4                              }
  62   3                              if (run){
  63   4                                      LCD_ShowString(1, 9, "run ");
  64   4                              } else {
  65   4                                      LCD_ShowString(1, 9, "stop");
  66   4                              }
  67   3                      }else if (keyNum == 4){         // ÂÅúÊ≠¢ËÆ°Ë¥π
  68   3                              LCD_ShowString(1, 1, "Price: ");
  69   3                              LCD_ShowString(1, 10, "    ");
  70   3                              LCD_WriteDecimal(1, 9, price);
  71   3                      }
  72   2                      if(Sec == 10 && s10 == 0){      // ËÆ°Êó∂ÂºÄÂßãÂçÅÁßíÂÜÖ‰∏∫Á≠âÂæÖÊó∂Èó¥Ôºå10ÁßíÊó∂ÂàáÊç¢Áä∂ÊÄÅ;   ‰∏é‰∏äÂêéÈù
             -¢ÁöÑÂà§Êñ≠ÁöÑÊÑè‰πâÊòØÔºöÂ¶ÇÊûúÂè™ÊúâÂâçÈù¢ÁöÑÂà§Êñ≠ÔºåÈÇ£‰πàTR1ÂºÄÂêØÁöÑÊÉÖÂÜµ‰∏ãÔºåSecÊ∞∏Ëøú‰∏çÂèòÔºåÊ∞∏ËøúÊòØ10ÔºåÈÇ£
             -‰πàÊåâÈîÆK3Â§±ÂéªÊÑè‰πâ
  73   3                              s10 = 1;                                // Âõ†‰∏∫ÔºåÊØèÊ¨°ÊåâÂÆåK3ÂàáÊç¢ÂÆåÊ®°ÂºèÂêéÔºåËøêË°åÂà∞ËøôÈáåÂèà‰ºöÂàáÊç¢ÂõûÂéª
  74   3                              TR0 = 0;                                // ÂÖ≥Èó≠ÂÆöÊó∂Âô®0
  75   3                              TR1 = 1;                                // ÊâìÂºÄÂÆöÊó∂Âô®1
  76   3                              LCD_ShowString(1, 9, "run ");
  77   3                      }
  78   2              }
  79   1      }
  80          
  81          
  82          
  83          void Timer0_Routine() interrupt 1{
  84   1              static unsigned int T0Count;
  85   1              TL0 = 0x66;             //ËÆæÁΩÆÂÆöÊó∂ÂàùÂÄº
  86   1              TH0 = 0xFC;             //ËÆæÁΩÆÂÆöÊó∂ÂàùÂÄº
  87   1              T0Count++;
  88   1              if(T0Count>=1000)       //ÂÆöÊó∂Âô®ÂàÜÈ¢ëÔºå1s
  89   1              {
  90   2                      T0Count=0;
  91   2                      Sec++;                  //1ÁßíÂà∞ÔºåSecËá™Â¢û
  92   2                      if(Sec>=60)
  93   2                      {
  94   3                              Sec=0;          //60ÁßíÂà∞ÔºåSecÊ∏Ö0ÔºåMinËá™Â¢û
  95   3                              Min++;
  96   3                              if(flag){
  97   4                                      price += 2.0;           // ÁôΩÁè≠Á≠âÂæÖ1ÂàÜÈíü2ÂùóÈí±
  98   4                              } else {
  99   4                                      price += 2.5;   // Â§úÁè≠Á≠âÂæÖ1ÂàÜÈíü2.5ÂùóÈí±
 100   4                              }
 101   3                              if(Min>=60)
 102   3                              {
 103   4                                      Min=0;  //60ÂàÜÈíüÂà∞ÔºåMinÊ∏Ö0ÔºåHourËá™Â¢û
 104   4                                      Hour++;
 105   4                                      if(Hour>=24)
 106   4                                      {
 107   5                                              Hour=0; //24Â∞èÊó∂Âà∞ÔºåHourÊ∏Ö0
 108   5                                      }
 109   4                              }
 110   3                      }
 111   2              }
 112   1              
C51 COMPILER V9.60.7.0   MAIN                                                              12/21/2023 02:04:33 PAGE 3   

 113   1      }
 114          
 115          void Timer1_Routine() interrupt 3{
 116   1              static unsigned int T1Count;
 117   1              TL1 = 0x66;             //ËÆæÁΩÆÂÆöÊó∂ÂàùÂÄº
 118   1              TH1 = 0xFC;             //ËÆæÁΩÆÂÆöÊó∂ÂàùÂÄº
 119   1              T1Count++;
 120   1              if(T1Count>=1000)       //ÂÆöÊó∂Âô®ÂàÜÈ¢ëÔºå1s
 121   1              {
 122   2                      T1Count=0;
 123   2                      runSec++;                       //1ÁßíÂà∞ÔºårunSecËá™Â¢û
 124   2                      if(runSec>=60)
 125   2                      {
 126   3                              runSec=0;                       // 60ÁßíÂà∞ÔºårunSecÊ∏Ö0ÔºårunMinËá™Â¢û
 127   3                              runMin++;                       // 60Áßí->1ÂàÜÈíüÔºåÂçïÁ∫ØÊîæÂú®ËøôÔºåÁúãÂæóÊõ¥ÊòéÁôΩ‰∫õ
 128   3                              dist ++;                        // 1ÂàÜÈíü->1ÂÖ¨ÈáåÔºà1Â∞èÊó∂60ÂÖ¨ÈáåÔºâ
 129   3                              if(flag){
 130   4                                      price += 2.0;           // ÁôΩÁè≠1ÂÖ¨Èáå2ÂùóÈí±
 131   4                              } else {
 132   4                                      price += 2.5;   // Â§úÁè≠1ÂÖ¨Èáå2.5ÂùóÈí±
 133   4                              }
 134   3                      }
 135   2              }
 136   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    712    ----
   CONSTANT SIZE    =     49    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     30    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
